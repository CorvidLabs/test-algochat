{
  "version": "1.0.0",
  "description": "AlgoChat cross-implementation test vectors",
  "protocol": {
    "version": 1,
    "protocolId": 1,
    "headerSize": 126,
    "tagSize": 16,
    "encryptedSenderKeySize": 48,
    "maxPayloadSize": 882,
    "encryption": "ChaCha20-Poly1305",
    "keyAgreement": "X25519",
    "keyDerivation": "HKDF-SHA256"
  },
  "keyDerivation": {
    "salt": "AlgoChat-v1-encryption",
    "info": "x25519-key",
    "outputBytes": 32
  },
  "envelopeFormat": {
    "description": "Binary envelope format (126-byte header + ciphertext)",
    "layout": [
      { "offset": 0, "size": 1, "field": "version", "value": "0x01" },
      { "offset": 1, "size": 1, "field": "protocolId", "value": "0x01" },
      { "offset": 2, "size": 32, "field": "senderPublicKey" },
      { "offset": 34, "size": 32, "field": "ephemeralPublicKey" },
      { "offset": 66, "size": 12, "field": "nonce" },
      { "offset": 78, "size": 48, "field": "encryptedSenderKey", "note": "32-byte key + 16-byte tag" },
      { "offset": 126, "size": "variable", "field": "ciphertext", "note": "message + 16-byte tag" }
    ]
  },
  "testKeys": {
    "alice": {
      "seedHex": "0000000000000000000000000000000000000000000000000000000000000001",
      "x25519PublicKeyHex": "a04407c78ff19a0bbd578588d6100bca4ed7f89acfc600666dbab1d36061c064"
    },
    "bob": {
      "seedHex": "0000000000000000000000000000000000000000000000000000000000000002",
      "x25519PublicKeyHex": "b43231dc85ba0781ad3df9b8f8458a5e6f4c1030d0526ace9540300e0398ae03"
    }
  },
  "testMessages": {
    "empty": "",
    "single_char": "X",
    "whitespace": "   \t\n   ",
    "numbers": "1234567890",
    "punctuation": "!@#$%^&*()_+-=[]{}\\|;':\",./<>?",
    "newlines": "Line 1\nLine 2\nLine 3",
    "emoji_simple": "Hello ğŸ‘‹ World ğŸŒ",
    "emoji_zwj": "Family: ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦",
    "chinese": "ä½ å¥½ä¸–ç•Œ - Hello World",
    "arabic": "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…",
    "japanese": "ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ ã‚«ã‚¿ã‚«ãƒŠ æ¼¢å­—",
    "korean": "ì•ˆë…•í•˜ì„¸ìš” ì„¸ê³„",
    "accents": "CafÃ© rÃ©sumÃ© naÃ¯ve",
    "cyrillic": "ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ Ğ¼Ğ¸Ñ€",
    "json": "{\"key\": \"value\", \"num\": 42}",
    "html": "<div class=\"test\">Content</div>",
    "url": "https://example.com/path?q=test&lang=en",
    "code": "func hello() { print(\"Hi\") }",
    "long_text_repeat": "The quick brown fox jumps over the lazy dog. ",
    "long_text_count": 11,
    "max_payload_char": "A",
    "max_payload_count": 882
  },
  "cryptoConstants": {
    "encryptionInfoPrefix": "AlgoChatV1",
    "senderKeyInfoPrefix": "AlgoChatV1-SenderKey"
  },
  "implementationChecklist": [
    "1. Derive X25519 keys from seed using HKDF-SHA256",
    "2. Verify derived public keys match testKeys above",
    "3. Encrypt each test message (Alice â†’ Bob)",
    "4. Verify envelope structure (126-byte header)",
    "5. Decrypt as recipient (Bob)",
    "6. Decrypt as sender (Alice) - bidirectional",
    "7. Cross-verify: decrypt Swift/TS envelopes",
    "8. Export envelopes for other implementations to verify"
  ]
}
