{
  "version": "1.0.0",
  "description": "AlgoChat cross-implementation test vectors",
  "protocol": {
    "version": 1,
    "protocolId": 1,
    "headerSize": 126,
    "tagSize": 16,
    "encryptedSenderKeySize": 48,
    "maxPayloadSize": 882,
    "encryption": "ChaCha20-Poly1305",
    "keyAgreement": "X25519",
    "keyDerivation": "HKDF-SHA256"
  },
  "keyDerivation": {
    "salt": "AlgoChat-v1-encryption",
    "info": "x25519-key",
    "outputBytes": 32
  },
  "envelopeFormat": {
    "description": "Binary envelope format (126-byte header + ciphertext)",
    "layout": [
      {
        "offset": 0,
        "size": 1,
        "field": "version",
        "value": "0x01"
      },
      {
        "offset": 1,
        "size": 1,
        "field": "protocolId",
        "value": "0x01"
      },
      {
        "offset": 2,
        "size": 32,
        "field": "senderPublicKey"
      },
      {
        "offset": 34,
        "size": 32,
        "field": "ephemeralPublicKey"
      },
      {
        "offset": 66,
        "size": 12,
        "field": "nonce"
      },
      {
        "offset": 78,
        "size": 48,
        "field": "encryptedSenderKey",
        "note": "32-byte key + 16-byte tag"
      },
      {
        "offset": 126,
        "size": "variable",
        "field": "ciphertext",
        "note": "message + 16-byte tag"
      }
    ]
  },
  "testKeys": {
    "alice": {
      "seedHex": "0000000000000000000000000000000000000000000000000000000000000001",
      "x25519PublicKeyHex": "a04407c78ff19a0bbd578588d6100bca4ed7f89acfc600666dbab1d36061c064"
    },
    "bob": {
      "seedHex": "0000000000000000000000000000000000000000000000000000000000000002",
      "x25519PublicKeyHex": "b43231dc85ba0781ad3df9b8f8458a5e6f4c1030d0526ace9540300e0398ae03"
    }
  },
  "testMessages": {
    "empty": "",
    "single_char": "X",
    "whitespace": "   \t\n   ",
    "numbers": "1234567890",
    "punctuation": "!@#$%^&*()_+-=[]{}\\|;':\",./<>?",
    "newlines": "Line 1\nLine 2\nLine 3",
    "emoji_simple": "Hello üëã World üåç",
    "emoji_zwj": "Family: üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
    "chinese": "‰Ω†Â•Ω‰∏ñÁïå - Hello World",
    "arabic": "ŸÖÿ±ÿ≠ÿ®ÿß ÿ®ÿßŸÑÿπÿßŸÑŸÖ",
    "japanese": "„Åì„Çì„Å´„Å°„ÅØ‰∏ñÁïå „Ç´„Çø„Ç´„Éä Êº¢Â≠ó",
    "korean": "ÏïàÎÖïÌïòÏÑ∏Ïöî ÏÑ∏Í≥Ñ",
    "accents": "Caf√© r√©sum√© na√Øve",
    "cyrillic": "–ü—Ä–∏–≤–µ—Ç –º–∏—Ä",
    "json": "{\"key\": \"value\", \"num\": 42}",
    "html": "<div class=\"test\">Content</div>",
    "url": "https://example.com/path?q=test&lang=en",
    "code": "func hello() { print(\"Hi\") }",
    "long_text_repeat": "The quick brown fox jumps over the lazy dog. ",
    "long_text_count": 11,
    "max_payload_char": "A",
    "max_payload_count": 882
  },
  "cryptoConstants": {
    "encryptionInfoPrefix": "AlgoChatV1",
    "senderKeyInfoPrefix": "AlgoChatV1-SenderKey"
  },
  "implementationChecklist": [
    "1. Derive X25519 keys from seed using HKDF-SHA256",
    "2. Verify derived public keys match testKeys above",
    "3. Encrypt each test message (Alice ‚Üí Bob)",
    "4. Verify envelope structure (126-byte header)",
    "5. Decrypt as recipient (Bob)",
    "6. Decrypt as sender (Alice) - bidirectional",
    "7. Cross-verify: decrypt Swift/TS envelopes",
    "8. Export envelopes for other implementations to verify"
  ],
  "psk_protocol": {
    "protocolId": 2,
    "headerSize": 130,
    "maxPayloadSize": 878,
    "sessionSize": 100,
    "counterWindow": 200
  },
  "psk_hkdf": {
    "sessionSalt": "AlgoChat-PSK-Session",
    "positionSalt": "AlgoChat-PSK-Position",
    "hybridInfoPrefix": "AlgoChatV1-PSK",
    "senderKeyInfoPrefix": "AlgoChatV1-PSK-SenderKey"
  },
  "psk_ratchet_vectors": {
    "initialPSK": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
    "session0": "a031707ea9e9e50bd8ea4eb9a2bd368465ea1aff14caab293d38954b4717e888",
    "session1": "994cffbb4f84fa5410d44574bb9fa7408a8c2f1ed2b3a00f5168fc74c71f7cea",
    "counter0": "2918fd486b9bd024d712f6234b813c0f4167237d60c2c1fca37326b20497c165",
    "counter99": "5b48a50a25261f6b63fe9c867b46be46de4d747c3477db6290045ba519a4d38b",
    "counter100": "7a15d3add6a28858e6a1f1ea0d22bdb29b7e129a1330c4908d9b46a460992694"
  },
  "psk_envelope_format": {
    "description": "Binary PSK envelope format (130-byte header + ciphertext)",
    "layout": [
      {
        "offset": 0,
        "size": 1,
        "field": "version",
        "value": "0x01"
      },
      {
        "offset": 1,
        "size": 1,
        "field": "protocolId",
        "value": "0x02"
      },
      {
        "offset": 2,
        "size": 4,
        "field": "ratchetCounter",
        "encoding": "big-endian uint32"
      },
      {
        "offset": 6,
        "size": 32,
        "field": "senderPublicKey"
      },
      {
        "offset": 38,
        "size": 32,
        "field": "ephemeralPublicKey"
      },
      {
        "offset": 70,
        "size": 12,
        "field": "nonce"
      },
      {
        "offset": 82,
        "size": 48,
        "field": "encryptedSenderKey",
        "note": "32-byte key + 16-byte tag"
      },
      {
        "offset": 130,
        "size": "variable",
        "field": "ciphertext",
        "note": "message + 16-byte tag"
      }
    ]
  }
}
